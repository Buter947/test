<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日文姓名假名轉換器</title>
    <style>
        /* --- 全局樣式 --- */
        body {
            margin: 0;
            background-color: #f8fafc !important; /* 頁面背景色 */
        }

        /* --- 主應用程式容器 --- */
        #jp-name-converter-app {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
            max-width: 700px !important;
            margin: 2rem auto !important;
            background-color: #fdfbf7 !important;
            padding: 2.5rem !important;
            border-radius: 0.75rem !important;
            border: 1px solid #e5e7eb !important;
        }

        /* --- 輸入區 --- */
        #jp-name-converter-app .input-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        #jp-name-converter-app .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        #jp-name-converter-app .input-label {
            font-weight: 600;
            color: #B45309;
            font-size: 0.9rem;
            padding-left: 0.25rem;
        }
        #jp-name-converter-app .name-input {
            width: 100% !important;
            box-sizing: border-box; /* 確保 padding 不會撐爆寬度 */
            padding: 1rem !important;
            font-size: 1.1rem !important;
            border: 1px solid #d1d5db !important;
            border-radius: 0.5rem !important;
            transition: all 0.2s;
        }
        #jp-name-converter-app .name-input:focus {
            outline: none !important;
            border-color: #B45309 !important;
            box-shadow: 0 0 0 3px rgba(180, 83, 9, 0.2) !important;
        }

        /* --- 按鈕區 --- */
        #jp-name-converter-app .button-area {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        #jp-name-converter-app .action-btn {
            border: none;
            padding: 0.75rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        #jp-name-converter-app #convert-btn {
            background-color: #B45309 !important;
            color: #ffffff !important;
        }
        #jp-name-converter-app #convert-btn:hover { background-color: #9a4708 !important; }
        #jp-name-converter-app #clear-btn {
            background-color: #e5e7eb !important;
            color: #4b5563 !important;
        }
        #jp-name-converter-app #clear-btn:hover { background-color: #d1d5db !important; }

        /* --- 結果區 --- */
        #jp-name-converter-app .results-section {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 0.5rem 1.5rem;
            margin-bottom: 1rem;
        }
        #jp-name-converter-app .result-item {
            display: grid;
            grid-template-columns: 100px 1fr auto auto;
            align-items: center;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        #jp-name-converter-app .result-item:last-child { border-bottom: none; }
        
        #jp-name-converter-app .result-label {
            font-weight: 600;
            color: #4b5563;
        }
        #jp-name-converter-app .result-text {
            font-size: 1.2rem;
            font-weight: 500;
            color: #111827;
            background-color: #f9fafb;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            word-break: break-all; /* 避免長音節撐爆版面 */
        }
        #jp-name-converter-app .result-btn {
            width: 36px; height: 36px;
            border-radius: 50%;
            border: 1px solid #d1d5db;
            background-color: #ffffff;
            color: #6b7280;
            cursor: pointer;
            display: flex; justify-content: center; align-items: center;
            font-size: 1.1rem;
            transition: all 0.2s;
        }
        #jp-name-converter-app .result-btn:hover {
            background-color: #f3f4f6;
            color: #111827;
        }
        #jp-name-converter-app #copy-feedback {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #374151;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none; /* 避免遮擋 */
        }

        /* 響應式設計 */
        @media (max-width: 640px) {
            #jp-name-converter-app .input-area {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            #jp-name-converter-app .result-item {
                grid-template-columns: 80px 1fr auto auto;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>

    <div id="jp-name-converter-app">
        <div class="input-area">
            <div class="input-group">
                <label for="last-name" class="input-label">姓 (Last Name)</label>
                <input type="text" id="last-name" class="name-input" placeholder="e.g. Chan">
            </div>
            <div class="input-group">
                <label for="first-name" class="input-label">名 (First Name)</label>
                <input type="text" id="first-name" class="name-input" placeholder="e.g. Kwan Jun">
            </div>
        </div>

        <div class="button-area">
            <button id="convert-btn" class="action-btn">轉換</button>
            <button id="clear-btn" class="action-btn">清空</button>
        </div>

        <div id="results-area" style="display: none;">
            <div id="last-name-results" class="results-section">
                 <div class="result-item">
                    <span class="result-label">姓 (ひらがな)</span>
                    <span id="last-hiragana-result" class="result-text"></span>
                    <button class="result-btn" data-target="last-hiragana-result" title="複製">📋</button>
                    <button class="result-btn speech-btn" data-target="last-hiragana-result" title="發音">🔊</button>
                </div>
                <div class="result-item">
                    <span class="result-label">姓 (カタカナ)</span>
                    <span id="last-katakana-result" class="result-text"></span>
                    <button class="result-btn" data-target="last-katakana-result" title="複製">📋</button>
                    <button class="result-btn speech-btn" data-target="last-katakana-result" title="發音">🔊</button>
                </div>
            </div>
            <div id="first-name-results" class="results-section">
                 <div class="result-item">
                    <span class="result-label">名 (ひらがな)</span>
                    <span id="first-hiragana-result" class="result-text"></span>
                    <button class="result-btn" data-target="first-hiragana-result" title="複製">📋</button>
                    <button class="result-btn speech-btn" data-target="first-hiragana-result" title="發音">🔊</button>
                </div>
                <div class="result-item">
                    <span class="result-label">名 (カタカナ)</span>
                    <span id="first-katakana-result" class="result-text"></span>
                    <button class="result-btn" data-target="first-katakana-result" title="複製">📋</button>
                    <button class="result-btn speech-btn" data-target="first-katakana-result" title="發音">🔊</button>
                </div>
            </div>
        </div>
        <div id="copy-feedback">已複製到剪貼簿！</div>
    </div>

    <script>
    (function() {
        function initializeConverter() {
            const app = document.getElementById('jp-name-converter-app');
            if (!app) return;

            const lastNameInput = app.querySelector('#last-name');
            const firstNameInput = app.querySelector('#first-name');
            const convertBtn = app.querySelector('#convert-btn');
            const clearBtn = app.querySelector('#clear-btn');
            const resultsArea = app.querySelector('#results-area');
            
            const surnameMap = {
                'chan': { katakana: 'チャン', hiragana: 'ちゃん' }, 'chen': { katakana: 'チェン', hiragana: 'ちぇん' },
                'lam': { katakana: 'ラム', hiragana: 'らむ' }, 'lin': { katakana: 'リン', hiragana: 'りん' },
                'wong': { katakana: 'ウォン', hiragana: 'うぉん' }, 'huang': { katakana: 'ホァン', hiragana: 'ほぁん' },
                'cheung': { katakana: 'チョン', hiragana: 'ちょん' }, 'chang': { katakana: 'チャン', hiragana: 'ちゃん' },
                'lee': { katakana: 'リー', hiragana: 'りー' }, 'li': { katakana: 'リ', hiragana: 'り' },
                'ng': { katakana: 'ン', hiragana: 'ん' }, 'wu': { katakana: 'ウー', hiragana: 'うー' },
                'lau': { katakana: 'ラウ', hiragana: 'らう' }, 'liu': { katakana: 'リュウ', hiragana: 'りゅう' },
                'choi': { katakana: 'チョイ', hiragana: 'ちょい' }, 'tsoi': { katakana: 'ツォイ', hiragana: 'つぉい' }, 'tsai': { katakana: 'ツァイ', hiragana: 'つぁい' },
                'yeung': { katakana: 'ヨン', hiragana: 'よん' }, 'yang': { katakana: 'ヤン', hiragana: 'やん' },
                'hui': { katakana: 'ホイ', hiragana: 'ほい' }, 'hsu': { katakana: 'シュー', hiragana: 'しゅー' },
                'cheng': { katakana: 'チェン', hiragana: 'ちぇん' },
                'tse': { katakana: 'ツェ', hiragana: 'つぇ' }, 'che': { katakana: 'チェ', hiragana: 'ちぇ' }, 'hsieh': { katakana: 'シェ', hiragana: 'しぇ' },
                'kwok': { katakana: 'クォク', hiragana: 'くぉく' }, 'kuo': { katakana: 'クオ', hiragana: 'くお' },
                'ho': { katakana: 'ホー', hiragana: 'ほー' },
                'leung': { katakana: 'リョン', hiragana: 'りょん' }, 'liang': { katakana: 'リャン', hiragana: 'りゃん' },
                'so': { katakana: 'ソー', hiragana: 'そー' }, 'su': { katakana: 'スー', hiragana: 'すー' },
                'yip': { katakana: 'イップ', hiragana: 'いっぷ' }, 'ip': { katakana: 'イップ', hiragana: 'いっぷ' }, 'yeh': { katakana: 'イエ', hiragana: 'いえ' },
                'chow': { katakana: 'チャウ', hiragana: 'ちゃう' }, 'chau': { katakana: 'チャウ', hiragana: 'ちゃう' }, 'chou': { katakana: 'チョウ', hiragana: 'ちょう' },
                'tsang': { katakana: 'ツァン', hiragana: 'つぁん' }, 'tseng': { katakana: 'ツェン', hiragana: 'つぇん' },
                'tang': { katakana: 'タン', hiragana: 'たん' }, 'teng': { katakana: 'テン', hiragana: 'てん' },
                'chung': { katakana: 'チョン', hiragana: 'ちょん' },
                'law': { katakana: 'ロー', hiragana: 'ろー' }, 'lo': { katakana: 'ロー', hiragana: 'ろー' },
                'lai': { katakana: 'ライ', hiragana: 'らい' },
                'liao': { katakana: 'リャオ', hiragana: 'りゃお' },
                'poon': { katakana: 'プーン', hiragana: 'ぷーん' }, 'pun': { katakana: 'パン', hiragana: 'ぱん' }, 'pan': { katakana: 'パン', hiragana: 'ぱん' },
                'yiu': { katakana: 'ユウ', hiragana: 'ゆう' }, 'yao': { katakana: 'ヤオ', hiragana: 'やお' },
                'yau': { katakana: 'ヤウ', hiragana: 'やう' }, 'chiu': { katakana: 'チウ', hiragana: 'ちう' },
                'siu': { katakana: 'シウ', hiragana: 'しう' }, 'hsiao': { katakana: 'シャオ', hiragana: 'しゃお' },
                'fung': { katakana: 'フォン', hiragana: 'ふぉん' }, 'feng': { katakana: 'フェン', hiragana: 'ふぇん' },
                'kong': { katakana: 'コン', hiragana: 'こん' }, 'chiang': { katakana: 'チャン', hiragana: 'ちゃん' },
                'tai': { katakana: 'タイ', hiragana: 'たい' },
                'woo': { katakana: 'ウー', hiragana: 'うー' }, 'hu': { katakana: 'フー', hiragana: 'ふー' },
                'lui': { katakana: 'ルイ', hiragana: 'るい' }, 'lu': { katakana: 'ルー', hiragana: 'るー' },
                'yuen': { katakana: 'ユン', hiragana: 'ゆん' }, 'yuan': { katakana: 'ユアン', hiragana: 'ゆあん' },
                'pang': { katakana: 'パン', hiragana: 'ぱん' }, 'peng': { katakana: 'ポン', hiragana: 'ぽん' },
                'shum': { katakana: 'シャム', hiragana: 'しゃむ' }, 'sum': { katakana: 'サム', hiragana: 'さむ' }, 'shen': { katakana: 'シェン', hiragana: 'しぇん' },
                'to': { katakana: 'トー', hiragana: 'とー' }, 'tu': { katakana: 'トゥ', hiragana: 'とぅ' },
                'tso': { katakana: 'ツォ', hiragana: 'つぉ' }, 'cho': { katakana: 'チョ', hiragana: 'ちょ' }, 'tsao': { katakana: 'ツァオ', hiragana: 'つぁお' },
                'ngai': { katakana: 'ガイ', hiragana: 'がい' }, 'wei': { katakana: 'ウェイ', hiragana: 'うぇい' },
                'kwan': { katakana: 'クァン', hiragana: 'くぁん' }, 'kuan': { katakana: 'クアン', hiragana: 'くあん' },
                'fan': { katakana: 'ファン', hiragana: 'ふぁん' },
                'kan': { katakana: 'カン', hiragana: 'かん' }, 'chien': { katakana: 'チェン', hiragana: 'ちぇん' },
                'fong': { katakana: 'フォン', hiragana: 'ふぉん' }, 'fang': { katakana: 'ファン', hiragana: 'ふぁん' },
                'mak': { katakana: 'マク', hiragana: 'まく' }, 'mai': { katakana: 'マイ', hiragana: 'まい' },
            };

            const romajiToHiraganaMap = {
                'a': 'あ', 'i': 'い', 'u': 'う', 'e': 'え', 'o': 'お', 'ka': 'か', 'ki': 'き', 'ku': 'く', 'ke': 'け', 'ko': 'こ', 'sa': 'さ', 'shi': 'し', 'su': 'す', 'se': 'せ', 'so': 'そ', 'ta': 'た', 'chi': 'ち', 'tsu': 'つ', 'te': 'て', 'to': 'と', 'na': 'な', 'ni': 'に', 'nu': 'ぬ', 'ne': 'ね', 'no': 'の', 'ha': 'は', 'hi': 'ひ', 'fu': 'ふ', 'he': 'へ', 'ho': 'ほ', 'ma': 'ま', 'mi': 'み', 'mu': 'む', 'me': 'め', 'mo': 'も', 'ya': 'や', 'yu': 'ゆ', 'yo': 'よ', 'ra': 'ら', 'ri': 'り', 'ru': 'る', 're': 'れ', 'ro': 'ろ', 'wa': 'わ', 'wo': 'を', 'n': 'ん', 'ga': 'が', 'gi': 'ぎ', 'gu': 'ぐ', 'ge': 'げ', 'go': 'ご', 'za': 'ざ', 'ji': 'じ', 'zu': 'ず', 'ze': 'ぜ', 'zo': 'ぞ', 'da': 'だ', 'di': 'ぢ', 'du': 'づ', 'de': 'で', 'do': 'ど', 'ba': 'ば', 'bi': 'び', 'bu': 'ぶ', 'be': 'べ', 'bo': 'ぼ', 'pa': 'ぱ', 'pi': 'ぴ', 'pu': 'ぷ', 'pe': 'ぺ', 'po': 'ぽ', 'kya': 'きゃ', 'kyu': 'きゅ', 'kyo': 'きょ', 'sha': 'しゃ', 'shu': 'しゅ', 'sho': 'しょ', 'cha': 'ちゃ', 'chu': 'ちゅ', 'cho': 'ちょ', 'nya': 'にゃ', 'nyu': 'にゅ', 'nyo': 'にょ', 'hya': 'ひゃ', 'hyu': 'ひゅ', 'hyo': 'ひょ', 'mya': 'みゃ', 'myu': 'みゅ', 'myo': 'みょ', 'rya': 'りゃ', 'ryu': 'りゅ', 'ryo': 'りょ', 'gya': 'ぎゃ', 'gyu': 'ぎゅ', 'gyo': 'ぎょ', 'ja': 'じゃ', 'ju': 'じゅ', 'jo': 'じょ', 'bya': 'びゃ', 'byu': 'びゅ', 'byo': 'びょ', 'pya': 'ぴゃ', 'pyu': 'ぴゅ', 'pyo': 'ぴょ', '-': 'ー'
            };

            function preprocessRomaji(text) {
                let processedText = text.toLowerCase();
                processedText = processedText.replace(/l/g, 'r');
                if (processedText.endsWith('m')) {
                    processedText = processedText.slice(0, -1) + 'n';
                }
                return processedText;
            }

            function convertRomajiToHiragana(text) {
                let result = ''; let i = 0;
                while (i < text.length) {
                    if (i + 1 < text.length && text[i] !== 'n' && text[i] === text[i+1]) { result += 'っ'; i++; continue; }
                    let sub3 = text.substring(i, i + 3);
                    if (romajiToHiraganaMap[sub3]) { result += romajiToHiraganaMap[sub3]; i += 3; continue; }
                    let sub2 = text.substring(i, i + 2);
                    if (romajiToHiraganaMap[sub2]) { result += romajiToHiraganaMap[sub2]; i += 2; continue; }
                    let sub1 = text.substring(i, i + 1);
                    if (romajiToHiraganaMap[sub1]) { result += romajiToHiraganaMap[sub1]; i += 1; } 
                    else { result += sub1; i += 1; }
                }
                return result;
            }

            function convertHiraganaToKatakana(hiragana) {
                return hiragana.replace(/[\u3041-\u3096]/g, match => String.fromCharCode(match.charCodeAt(0) + 0x60));
            }

            function cleanupResult(text) {
                return text.replace(/[a-zA-Z]/g, '');
            }

            convertBtn.addEventListener('click', () => {
                const lastNameRaw = lastNameInput.value.trim();
                const firstNameRaw = firstNameInput.value.trim();

                if (!lastNameRaw || !firstNameRaw) {
                    alert('請同時輸入「姓」和「名」的英文拼音。');
                    return;
                }
                
                let lastNameHira, lastNameKata, firstNameHira, firstNameKata;
                const lastNameLower = lastNameRaw.toLowerCase();
                if (surnameMap[lastNameLower]) {
                    lastNameHira = surnameMap[lastNameLower].hiragana;
                    lastNameKata = surnameMap[lastNameLower].katakana;
                } else {
                    const lastNameProcessed = preprocessRomaji(lastNameRaw);
                    lastNameHira = convertRomajiToHiragana(lastNameProcessed);
                    lastNameKata = convertHiraganaToKatakana(lastNameHira);
                }
                
                const firstNameProcessed = preprocessRomaji(firstNameRaw);
                firstNameHira = convertRomajiToHiragana(firstNameProcessed);
                firstNameKata = convertHiraganaToKatakana(firstNameHira);

                app.querySelector('#last-hiragana-result').textContent = cleanupResult(lastNameHira);
                app.querySelector('#last-katakana-result').textContent = cleanupResult(lastNameKata);
                app.querySelector('#first-hiragana-result').textContent = cleanupResult(firstNameHira);
                app.querySelector('#first-katakana-result').textContent = cleanupResult(firstNameKata);

                resultsArea.style.display = 'block';
            });

            clearBtn.addEventListener('click', () => {
                lastNameInput.value = '';
                firstNameInput.value = '';
                resultsArea.style.display = 'none';
            });

            resultsArea.addEventListener('click', (e) => {
                const target = e.target.closest('.result-btn');
                if (!target) return;
                const targetId = target.dataset.target;
                const textEl = app.querySelector(`#${targetId}`);
                if (!textEl) return;
                const text = textEl.textContent;
                if (target.classList.contains('speech-btn')) {
                    if (text && window.speechSynthesis) {
                        const utterance = new SpeechSynthesisUtterance(text);
                        utterance.lang = 'ja-JP';
                        window.speechSynthesis.speak(utterance);
                    }
                } else {
                    copyToClipboard(text);
                }
            });

            function copyToClipboard(text) {
                const feedback = app.querySelector('#copy-feedback');
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                feedback.style.opacity = 1;
                setTimeout(() => { feedback.style.opacity = 0; }, 2000);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeConverter);
        } else {
            initializeConverter();
        }
    })();
    </script>
</body>
</html>
